## 동시성 이슈 보고서
> 이커머스 시나리오에서 발생 가능한 동시성 이슈 분석

### 1. 문제 식별
> 상품 재고 감소 시 너무 많은 트랜잭션이 발생할 경우 동시성 문제 발생

### 2. 분석
> 상품 재고 감소 시에 동시성 문제가 발생할 경우 예상되는 재고 차감이 안될 수 있다.

### 3. 해결
> 트랜잭션이 많이 발생하더라도 상품 재고 카운트가 정확히 되도록 한다. 

### 4. 대안
> - 비관적 락 적용: 상품 재고 감소는 주문 후 반드시 처리해야 하는 로직이기 때문에 재고 처리가 정확히 되도록 조회 쿼리에 `@Lock(LockModeType.PESSIMISTIC_WRITE)`을 적용한다.

---
---

### 1. 문제 식별
> 쿠폰 발급 시 너무 많은 트랜잭션이 발생할 경우 동시성 문제 발생

### 2. 분석
> 쿠폰 발급 시에 동시성 문제가 발생할 경우 쿠폰 수량 체크가 제대로 되지 않아 더 많은 양의 쿠폰이 발급될 수 있다.

### 3. 해결
> 트랜잭션이 많이 발생하더라도 쿠폰 발급 시에 `낙관적 락`을 적용하여 선착순으로 발급되도록 처리한다.  

### 4. 대안
> - 낙관적 락 적용
>   - 낙관적 락이 적용될 수 있도록 @Value 필드 추가 및 실패 시 재시도를 위해 해당 메소드에 @Retryable 를 적용한다.
